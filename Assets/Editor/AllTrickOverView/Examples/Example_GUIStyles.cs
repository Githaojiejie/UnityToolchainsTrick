using AllTrickOverView.Core;

namespace AllTrickOverView.Examples
{
    public class Example_GUIStyles : AExample_Base
    {
        public static TrickOverViewInfo TrickOverViewInfo =
            new TrickOverViewInfo("GUIStyles",
                "GUIStyle预览",
                "Others",
                "using System;\nusing UnityEditor;\nusing UnityEngine;\nusing System.Collections.Generic;\n\nnamespace ToolKits\n{\n    public class BuiltInResourcesWindow : EditorWindow\n    {\n        [MenuItem(\"Tools/GUIStyles Preview\", priority = 4)]\n        public static void ShowWindow()\n        {\n            BuiltInResourcesWindow w =\n                (BuiltInResourcesWindow) EditorWindow.GetWindow<BuiltInResourcesWindow>(\"GUIStyles Preview\");\n            w.Show();\n        }\n\n        private struct Drawing\n        {\n            public Rect Rect;\n            public System.Action Draw;\n        }\n\n        private List<Drawing> Drawings;\n\n        private List<UnityEngine.Object> _objects;\n        private float _scrollPos;\n        private float _maxY;\n        private Rect _oldPosition;\n\n        private bool _showingStyles = true;\n        private bool _showingIcons = false;\n\n        private string _search = \"\";\n\n        void OnGUI()\n        {\n            if (position.width != _oldPosition.width && Event.current.type == EventType.Layout)\n            {\n                Drawings = null;\n                _oldPosition = position;\n            }\n\n            // GUILayout.BeginHorizontal();\n            //\n            // if (GUILayout.Toggle(_showingStyles, \"Styles\", EditorStyles.toolbarButton) != _showingStyles)\n            // {\n            //     _showingStyles = !_showingStyles;\n            //     _showingIcons = !_showingStyles;\n            //     Drawings = null;\n            // }\n\n            // if (GUILayout.Toggle(_showingIcons, \"Icons\", EditorStyles.toolbarButton) != _showingIcons)\n            // {\n            //     _showingIcons = !_showingIcons;\n            //     _showingStyles = !_showingIcons;\n            //     Drawings = null;\n            // }\n\n            // GUILayout.EndHorizontal();\n\n            GUILayout.Button(\"Styles\");\n            string newSearch = GUILayout.TextField(_search);\n            if (newSearch != _search)\n            {\n                _search = newSearch;\n                Drawings = null;\n            }\n\n            float top = 36;\n\n            if (Drawings == null)\n            {\n                string lowerSearch = _search.ToLower();\n\n                Drawings = new List<Drawing>();\n\n                GUIContent inactiveText = new GUIContent(\"inactive\");\n                GUIContent activeText = new GUIContent(\"active\");\n\n                float x = 5.0f;\n                float y = 5.0f;\n\n                if (_showingStyles)\n                {\n                    foreach (GUIStyle ss in GUI.skin)\n                    {\n                        if (lowerSearch != \"\" && !ss.name.ToLower().Contains(lowerSearch))\n                            continue;\n\n                        GUIStyle thisStyle = ss;\n\n                        Drawing draw = new Drawing();\n\n                        float width = Mathf.Max(\n                            100.0f,\n                            GUI.skin.button.CalcSize(new GUIContent(ss.name)).x,\n                            ss.CalcSize(inactiveText).x + ss.CalcSize(activeText).x\n                        ) + 16.0f;\n\n                        float height = 60.0f;\n\n                        if (x + width > position.width - 32 && x > 5.0f)\n                        {\n                            x = 5.0f;\n                            y += height + 10.0f;\n                        }\n\n                        draw.Rect = new Rect(x, y, width, height);\n\n                        width -= 8.0f;\n\n                        draw.Draw = () =>\n                        {\n                            if (GUILayout.Button(thisStyle.name, GUILayout.Width(width)))\n                            GUILayout.Toggle(true, inactiveText, thisStyle, GUILayout.Width(width / 2));\n                            GUILayout.Toggle(false, activeText, thisStyle, GUILayout.Width(width / 2));\n                            GUILayout.EndHorizontal();\n                        };\n\n                        x += width + 18.0f;\n\n                        Drawings.Add(draw);\n                    }\n                }\n\n                _maxY = y;\n            }\n\n            Rect r = position;\n            r.y = top;\n            r.height -= r.y;\n            r.x = r.width - 16;\n            r.width = 16;\n\n            float areaHeight = position.height - top;\n            _scrollPos = GUI.VerticalScrollbar(r, _scrollPos, areaHeight, 0.0f, _maxY);\n\n            Rect area = new Rect(0, top, position.width - 16.0f, areaHeight);\n            GUILayout.BeginArea(area);\n            int count = 0;\n            foreach (Drawing draw in Drawings)\n            {\n                Rect newRect = draw.Rect;\n                newRect.y -= _scrollPos;\n\n                if (newRect.y + newRect.height > 0 && newRect.y < areaHeight)\n                {\n                    GUILayout.BeginArea(newRect, GUI.skin.textField);\n                    draw.Draw();\n                    GUILayout.EndArea();\n\n                    count++;\n                }\n            }\n\n            GUILayout.EndArea();\n        }\n\n        void CopyText(string pText)\n        {\n            TextEditor editor = new TextEditor();\n\n            //editor.content = new GUIContent(pText); // Unity 4.x code\n            editor.text = pText; // Unity 5.x code\n\n            editor.SelectAll();\n            editor.Copy();\n        }\n    }\n}",
                "Assets/Editor/Examples/Example_04_GUIStyles",
                typeof(Example_GUIStyles),
                picPath : "Assets/Editor/Examples/Example_04_GUIStyles/QQ截图20210419152857.png",
                videoPath : "");

        public override TrickOverViewInfo GetTrickOverViewInfo()
        {
            return TrickOverViewInfo;
        }
    }
}
